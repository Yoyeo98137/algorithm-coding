## 121. 买卖股票的最佳时机

### 题意

给定一个数组 prices ，它的第 i 个元素 prices[i] 表示一支给定股票第 i 天的价格。

你只能选择 某一天 买入这只股票，并选择在 未来的某一个不同的日子 卖出该股票。设计一个算法来计算你所能获取的最大利润。

返回你可以从这笔交易中获取的最大利润。如果你不能获取任何利润，返回 0 。

### 难度

⭐⭐

### 示例

**示例 1：**

```javascript
输入：[7,1,5,3,6,4]
输出：5
解释：在第 2 天（股票价格 = 1）的时候买入，在第 5 天（股票价格 = 6）的时候卖出，最大利润 = 6-1 = 5 。
     注意利润不能是 7-1 = 6, 因为卖出价格需要大于买入价格；同时，你不能在买入前卖出股票。
```

**示例 2：**

```javascript
输入：prices = [7,6,4,3,1]
输出：0
解释：在这种情况下, 没有交易完成, 所以最大利润为 0。
```

### 标签

数组、动态规划

### 实现

```javascript

/**
 * @param {number[]} prices
 * @return {number}
 */
var maxProfit = function(prices) {
    /**
        遇到此类题目，通过现实场景进行思考

        我们想象买卖股票这个场景，怎么来获得最大利润？
        最理想的结果就是，在股票 最低价 的时候买入它，
        然后在股票 最高价 的时候卖出它，这样就是我们理论上的 最大利润。

        所以我们需要记录三个对应的字段：最低的买入价、最高的卖出价、最大利润

        具体实现上，首先将 buyPrice 定义成语言中最大的数值，保证在遍历的时候能做一个 最小值 的比较
        我们存在利润的条件一定是 当前股票价格 大于 前一天的股票价格，这样才表示今天我们的股票有涨幅了
        
        所以在遍历的时候，我们从下标一作为开始，以 当前值 大于 前一个值 作为存在利润的条件
        然后将 之前记录的最低买入价 与 前一天的股票价 进行比较，取最小值作为 最低买入价
        当前的股票价格自然就是目前为止能卖出的最高价
        最后将 之前记录的最大利润值 与 今天能卖出得到的最大利润值 进行比较，取最大值就是答案了
     */

    let buyPrice = Number.MAX_VALUE,
        sellPrice = 0,
        maxProfit = 0;
    
    for (let i = 1; i < prices.length; i++) {
        // 存在利润
        if (prices[i] > prices[i - 1]) {
            // 记录最低的 买入点
            buyPrice = Math.min(buyPrice, prices[i - 1])
            // 当前这一天的股票价格就是我们能卖出的价格
            sellPrice = prices[i]
            // 记录最大利润
            maxProfit = Math.max(maxProfit, sellPrice - buyPrice)
        }
    }
    
    return maxProfit
};

时间复杂度：O(n)，只需要遍历一次。
空间复杂度：O(1)，只使用了常数个变量。

/**

    动态规划 DP

    首先我们需要写出状态转换方程，那以什么为状态呢？
    题目要求 最大利润，我们可以定义 f(i) 为 第i天时股票可以获取的最大利润

    f(i) 的值跟什么有关呢，此时就是最重要的一步发现 重叠子问题，
    股票可能是在 第i-1天（之前） 前卖出的，也可能是在 第i天（现在） 卖出的，要取两者的最大值，

    所以可以写出方程：f(i) = Max(f(i-1), prices[i] - minprice)
    其中的 minprice 为 第i天之前的最低股票价格

    接下来可以使用dp数组来存储 f(i) 的值
    确定 base case: dp[0] = 0 // 在第0天没有买入股票，最大利润为0
    dp[i] = Max(dp[i-1], prices[i] - min)

    因为每次用到的dp[i]，均是 dp[i-1] 即 第i-1天前可以获取的最大利润，只需要一个变量即可

    此时可以进一步维护dp数组，将其直接用 maxprofit 代替：
    maxprofit = Math.max(maxprofit, prices[i] - minprice)
    而初始状态的 maxprofit 即为 0

    前 i 天的最大收益 = max{ 前 i - 1 天的最大收益，第 i 天的价格 - 前 i - 1 天中的最小价格 }
*/

```
